<!DOCTYPE html>
<html>
<head>
    <title>Test Taux API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { padding: 10px 20px; margin: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
        #resultat { margin-top: 20px; padding: 10px; border: 1px solid #ccc; background: #f9f9f9; }
        pre { white-space: pre-wrap; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>Test de l'API Taux</h1>
    
    <button onclick="testerTaux()">Tester l'API Taux</button>
    <button onclick="testerApiDirecte()">Tester API C# Directe</button>
    <button onclick="viderResultat()">Vider</button>
    
    <div id="resultat"></div>

    <script>
        function testerTaux() {
            console.log('=== TEST API JAVA ===');
            const resultat = document.getElementById('resultat');
            resultat.innerHTML = 'Test en cours...';
            
            fetch('/central-banque/pret/api?action=taux')
                .then(response => {
                    console.log('Status:', response.status);
                    console.log('Headers:', [...response.headers.entries()]);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return response.text();
                })
                .then(data => {
                    console.log('Données reçues:', data);
                    resultat.innerHTML = `
                        <div class="success">
                            <h3>✅ Succès - API Java</h3>
                            <pre>${data}</pre>
                        </div>
                    `;
                })
                .catch(error => {
                    console.error('Erreur:', error);
                    resultat.innerHTML = `
                        <div class="error">
                            <h3>❌ Erreur - API Java</h3>
                            <p>${error.message}</p>
                        </div>
                    `;
                });
        }
        
        function testerApiDirecte() {
            console.log('=== TEST API C# DIRECTE ===');
            const resultat = document.getElementById('resultat');
            resultat.innerHTML = 'Test API C# en cours...';
            
            fetch('https://localhost:7002/api/Pret/taux')
                .then(response => {
                    console.log('Status API C#:', response.status);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return response.text();
                })
                .then(data => {
                    console.log('Données API C# reçues:', data);
                    resultat.innerHTML = `
                        <div class="success">
                            <h3>✅ Succès - API C# Directe</h3>
                            <pre>${data}</pre>
                        </div>
                    `;
                })
                .catch(error => {
                    console.error('Erreur API C#:', error);
                    resultat.innerHTML = `
                        <div class="error">
                            <h3>❌ Erreur - API C# Directe</h3>
                            <p>${error.message}</p>
                            <p>L'API C# n'est probablement pas démarrée ou accessible.</p>
                        </div>
                    `;
                });
        }
        
        function viderResultat() {
            document.getElementById('resultat').innerHTML = '';
        }
        
        // Test automatique au chargement
        window.onload = function() {
            console.log('Page de test chargée');
        };
    </script>
</body>
</html>
